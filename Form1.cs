using System;
using System.Collections.Specialized;
using System.Diagnostics;
using System.Drawing;
using System.Drawing.Drawing2D;
using System.Windows.Forms;
using System.Windows.Forms.VisualStyles;

namespace _3DRenderer
{
    public partial class Form1 : Form
    {
        private readonly double[,] cube = new double[8, 3] {
                { -1D, -1D , +1D },
                { +1D, -1D , +1D },
                { -1D, +1D , +1D },
                { +1D, +1D , +1D },
                { -1D, -1D , -1D },
                { +1D, -1D , -1D },
                { -1D, +1D , -1D },
                { +1D, +1D , -1D }
            };
        private readonly int[,] cubeEdges = new int[12, 3] {
                { 0, 1, 1 }, // 3rd is color [black, red, blue]
                { 3, 2, 1 },
                { 3, 1, 1 },
                { 2, 0, 1 },

                { 4, 5, 2 },
                { 7, 6, 2 },
                { 7, 5, 2 },
                { 6, 4, 2 },

                { 4, 0, 0 },
                { 5, 1, 0 },
                { 6, 2, 0 },
                { 7, 3, 0 }
            };
        private readonly double[,] pyramid = new double[5, 3]
            {
                { -1, -1, -1},
                { +1, -1, -1},
                { -1, -1, +1},
                { +1, -1, +1},
                { 0, +1, 0},
            };
        private readonly int[,] pyramidEdges = new int[8, 3]
        {
            { 0,1,2 },
            { 3,2,2 },
            { 3,1,2 },
            { 2,0,2 },

            { 0,4,0 },
            { 1,4,1 },
            { 2,4,1 },
            { 3,4,0 },
        };
        private readonly double[,] sphere = new double[600, 3]
            {
                {0.0, 1.0, 0.0},
                {0.0, 0.9941379571543596, 0.10811901842394177},
                {0.0, 0.9766205557100867, 0.21497044021102407},
                {0.0, 0.9476531711828025, 0.31930153013598},
                {0.0, 0.907575419670957, 0.4198891015602646},
                {0.0, 0.8568571761675893, 0.5155538571770217},
                {0.0, 0.7960930657056438, 0.6051742151937651},
                {0.0, 0.7259954919231308, 0.6876994588534232},
                {0.0, 0.6473862847818277, 0.7621620551276365},
                {0.0, 0.5611870653623823, 0.8276889981568906},
                {0.0, 0.46840844069979015, 0.8835120444460229},
                {0.0, 0.37013815533991434, 0.9289767198167914},
                {0.0, 0.26752833852922075, 0.963549992519223},
                {0.0, 0.16178199655276462, 0.9868265225415261},
                {0.0, 0.05413890858541761, 0.9985334138511238},
                {0.0, -0.054138908585417485, 0.9985334138511238},
                {0.0, -0.16178199655276473, 0.9868265225415261},
                {0.0, -0.26752833852922087, 0.9635499925192229},
                {0.0, -0.37013815533991445, 0.9289767198167914},
                {0.0, -0.46840844069979004, 0.8835120444460229},
                {0.0, -0.5611870653623823, 0.8276889981568906},
                {0.0, -0.6473862847818276, 0.7621620551276365},
                {0.0, -0.7259954919231308, 0.6876994588534232},
                {0.0, -0.7960930657056438, 0.6051742151937651},
                {0.0, -0.8568571761675893, 0.5155538571770216},
                {0.0, -0.9075754196709571, 0.41988910156026443},
                {0.0, -0.9476531711828025, 0.3193015301359798},
                {0.0, -0.9766205557100867, 0.21497044021102427},
                {0.0, -0.9941379571543596, 0.10811901842394192},
                {0.0, -1.0, 1.2246467991473532e-16},
                {0.0, 1.0, 0.0},
                {0.03510618789318528, 0.9941379571543596, 0.1022608317811127},
                {0.06980078783121665, 0.9766205557100867, 0.203322748807562},
                {0.10367703735139594, 0.9476531711828025, 0.3020008925040047},
                {0.13633776840144934, 0.907575419670957, 0.3971383518578871},
                {0.16740006377180613, 0.8568571761675893, 0.48761972714329366},
                {0.1964997464497764, 0.7960930657056438, 0.5723842069629133},
                {0.22329564926205456, 0.7259954919231308, 0.6504380052917639},
                {0.24747361474789425, 0.6473862847818277, 0.7208660127097082},
                {0.2687501783680986, 0.5611870653623823, 0.7828425252227119},
                {0.28687589186756834, 0.46840844069979015, 0.835640924887226},
                {0.3016382478280201, 0.37013815533991434, 0.878642198741221},
                {0.31286417112316844, 0.26752833852922075, 0.9113421961651986},
                {0.3204220480663371, 0.16178199655276462, 0.9333575395872554},
                {0.3242232694606004, 0.05413890858541761, 0.9444301192345882},
                {0.3242232694606004, -0.054138908585417485, 0.9444301192345882},
                {0.3204220480663371, -0.16178199655276473, 0.9333575395872554},
                {0.3128641711231684, -0.26752833852922087, 0.9113421961651985},
                {0.3016382478280201, -0.37013815533991445, 0.878642198741221},
                {0.28687589186756834, -0.46840844069979004, 0.835640924887226},
                {0.2687501783680986, -0.5611870653623823, 0.7828425252227119},
                {0.24747361474789425, -0.6473862847818276, 0.7208660127097082},
                {0.22329564926205456, -0.7259954919231308, 0.6504380052917639},
                {0.1964997464497764, -0.7960930657056438, 0.5723842069629133},
                {0.1674000637718061, -0.8568571761675893, 0.48761972714329355},
                {0.1363377684014493, -0.9075754196709571, 0.39713835185788693},
                {0.10367703735139587, -0.9476531711828025, 0.30200089250400447},
                {0.06980078783121672, -0.9766205557100867, 0.20332274880756215},
                {0.035106187893185335, -0.9941379571543596, 0.10226083178111285},
                {3.9764216564636016e-17, -1.0, 1.1582920576270607e-16},
                {0.0, 1.0, 0.0},
                {0.06640807559951345, 0.9941379571543596, 0.08532109727450747},
                {0.13203757723010515, 0.9766205557100867, 0.1696418826932945},
                {0.196119058990782, 0.9476531711828025, 0.2519737721425552},
                {0.2579012240981576, 0.907575419670957, 0.3313514994952612},
                {0.3166597331543201, 0.8568571761675893, 0.4068444334739505},
                {0.37170569636400325, 0.7960930657056438, 0.47756748845157054},
                {0.4223937501375777, 0.7259954919231308, 0.5426915012712146},
                {0.46812962338907776, 0.6473862847818277, 0.6014529524260253},
                {0.5083771048213372, 0.5611870653623823, 0.6531629176273193},
                {0.5426643295131861, 0.46840844069979015, 0.6972151448119837},
                {0.570589311104221, 0.37013815533991434, 0.7330931618936136},
                {0.5918246547173411, 0.26752833852922075, 0.7603763319255109},
                {0.6061213953643424, 0.16178199655276462, 0.7787447846842916},
                {0.6133119168327735, 0.05413890858541761, 0.7879831668557957},
                {0.6133119168327735, -0.054138908585417485, 0.7879831668557957},
                {0.6061213953643424, -0.16178199655276473, 0.7787447846842916},
                {0.591824654717341, -0.26752833852922087, 0.7603763319255108},
                {0.570589311104221, -0.37013815533991445, 0.7330931618936136},
                {0.5426643295131861, -0.46840844069979004, 0.6972151448119837},
                {0.5083771048213372, -0.5611870653623823, 0.6531629176273193},
                {0.46812962338907776, -0.6473862847818276, 0.6014529524260253},
                {0.4223937501375777, -0.7259954919231308, 0.5426915012712146},
                {0.37170569636400325, -0.7960930657056438, 0.47756748845157054},
                {0.31665973315432, -0.8568571761675893, 0.4068444334739504},
                {0.25790122409815747, -0.9075754196709571, 0.3313514994952611},
                {0.19611905899078186, -0.9476531711828025, 0.251973772142555},
                {0.13203757723010526, -0.9766205557100867, 0.16964188269329467},
                {0.06640807559951355, -0.9941379571543596, 0.0853210972745076},
                {7.521936325910146e-17, -1.0, 9.664183989098052e-17},
                {0.0, 1.0, 0.0},
                {0.09051361788717277, 0.9941379571543596, 0.05913549798497969},
                {0.17996604636200847, 0.9766205557100867, 0.11757768632418691},
                {0.267308537487775, 0.9476531711828025, 0.17464138379354685},
                {0.3515170804140239, 0.907575419670957, 0.22965757071406737},
                {0.4316044069675499, 0.8568571761675893, 0.2819812325958848},
                {0.5066315664690539, 0.7960930657056438, 0.33099892234341505},
                {0.575718934071367, 0.7259954919231308, 0.3761359523616695},
                {0.6380565235565345, 0.6473862847818277, 0.41686313224286436},
                {0.6929134836836446, 0.5611870653623823, 0.4527029730401081},
                {0.7396466667514037, 0.46840844069979015, 0.48323528538873206},
                {0.777708168916899, 0.37013815533991434, 0.5081021058424079},
                {0.8066517538672037, 0.26752833852922075, 0.5270118936672673},
                {0.8261380845321472, 0.16178199655276462, 0.5397429488904474},
                {0.8359387015012053, 0.05413890858541761, 0.5461460115295712},
                {0.8359387015012053, -0.054138908585417485, 0.5461460115295712},
                {0.8261380845321472, -0.16178199655276473, 0.5397429488904474},
                {0.8066517538672036, -0.26752833852922087, 0.5270118936672672},
                {0.777708168916899, -0.37013815533991445, 0.5081021058424079},
                {0.7396466667514037, -0.46840844069979004, 0.48323528538873206},
                {0.6929134836836446, -0.5611870653623823, 0.4527029730401081},
                {0.6380565235565345, -0.6473862847818276, 0.41686313224286436},
                {0.575718934071367, -0.7259954919231308, 0.3761359523616695},
                {0.5066315664690539, -0.7960930657056438, 0.33099892234341505},
                {0.4316044069675498, -0.8568571761675893, 0.2819812325958847},
                {0.35151708041402374, -0.9075754196709571, 0.22965757071406728},
                {0.26730853748777483, -0.9476531711828025, 0.17464138379354674},
                {0.17996604636200864, -0.9766205557100867, 0.11757768632418703},
                {0.0905136178871729, -0.9941379571543596, 0.059135497984979774},
                {1.0252332479576679e-16, -1.0, 6.698183111441706e-17},
                {0.0, 1.0, 0.0},
                {0.10481060521326852, 0.9941379571543596, 0.026541649906986393},
                {0.20839240190966166, 0.9766205557100867, 0.0527721232360753},
                {0.3095309882286541, 0.9476531711828025, 0.07838389167023364},
                {0.407040606717547, 0.907575419670957, 0.10307668064163408},
                {0.4997780462534524, 0.8568571761675893, 0.12656098977641922},
                {0.5866560451484615, 0.7960930657056438, 0.14856148702189229},
                {0.666656038298842, 0.7259954919231308, 0.16882023666309662},
                {0.7388400989295973, 0.6473862847818277, 0.18709972338324052},
                {0.8023619349283476, 0.5611870653623823, 0.20318563691362437},
                {0.8564768108465761, 0.46840844069979015, 0.2168893846255954},
                {0.9005502792418444, 0.37013815533991434, 0.2280503026066868},
                {0.9340656189939746, 0.26752833852922075, 0.23653753929809493},
                {0.9566298933877401, 0.16178199655276462, 0.24225158960956744},
                {0.9679785569365869, 0.05413890858541761, 0.2451254615256084},
                {0.9679785569365869, -0.054138908585417485, 0.2451254615256084},
                {0.9566298933877401, -0.16178199655276473, 0.24225158960956744},
                {0.9340656189939744, -0.26752833852922087, 0.2365375392980949},
                {0.9005502792418444, -0.37013815533991445, 0.2280503026066868},
                {0.8564768108465761, -0.46840844069979004, 0.2168893846255954},
                {0.8023619349283476, -0.5611870653623823, 0.20318563691362437},
                {0.7388400989295973, -0.6473862847818276, 0.18709972338324052},
                {0.666656038298842, -0.7259954919231308, 0.16882023666309662},
                {0.5866560451484615, -0.7960930657056438, 0.14856148702189229},
                {0.4997780462534523, -0.8568571761675893, 0.1265609897764192},
                {0.4070406067175468, -0.9075754196709571, 0.10307668064163404},
                {0.30953098822865394, -0.9476531711828025, 0.07838389167023359},
                {0.20839240190966185, -0.9766205557100867, 0.05277212323607535},
                {0.10481060521326865, -0.9941379571543596, 0.02654164990698643},
                {1.1871729327751938e-16, -1.0, 3.006330160641085e-17},
                {0.0, 1.0, -0.0},
                {0.1077497371604028, 0.9941379571543596, -0.008928397774560145},
                {0.21423620716912406, 0.9766205557100867, -0.017752118248525506},
                {0.31821095352681955, 0.9476531711828025, -0.026367711366943405},
                {0.4184549673974624, 0.907575419670957, -0.0346741671778123},
                {0.5137929793723953, 0.8568571761675893, -0.042574100081414726},
                {0.6031072384295877, 0.7960930657056438, -0.049974890587433485},
                {0.6853506165423999, 0.7259954919231308, -0.05678977119379278},
                {0.7595588852982972, 0.6473862847818277, -0.06293884365628784},
                {0.8248620205953833, 0.5611870653623823, -0.06835001572244645},
                {0.8804944028795261, 0.46840844069979015, -0.0729598463472747},
                {0.9258037933336163, 0.37013815533991434, -0.07671428948150484},
                {0.9602589807813504, 0.26752833852922075, -0.07956932771210809},
                {0.9834560096525818, 0.16178199655276462, -0.08149148832621697},
                {0.9951229159930415, 0.05413890858541761, -0.08245823574807928},
                {0.9951229159930415, -0.054138908585417485, -0.08245823574807928},
                {0.9834560096525818, -0.16178199655276473, -0.08149148832621697},
                {0.9602589807813503, -0.26752833852922087, -0.07956932771210808},
                {0.9258037933336163, -0.37013815533991445, -0.07671428948150484},
                {0.8804944028795261, -0.46840844069979004, -0.0729598463472747},
                {0.8248620205953833, -0.5611870653623823, -0.06835001572244645},
                {0.7595588852982972, -0.6473862847818276, -0.06293884365628784},
                {0.6853506165423999, -0.7259954919231308, -0.05678977119379278},
                {0.6031072384295877, -0.7960930657056438, -0.049974890587433485},
                {0.5137929793723952, -0.8568571761675893, -0.04257410008141472},
                {0.41845496739746224, -0.9075754196709571, -0.034674167177812285},
                {0.31821095352681933, -0.9476531711828025, -0.026367711366943387},
                {0.21423620716912425, -0.9766205557100867, -0.01775211824852552},
                {0.10774973716040295, -0.9941379571543596, -0.008928397774560157},
                {1.2204640094405062e-16, -1.0, -1.0113053110837518e-17},
                {0.0, 1.0, -0.0},
                {0.0990125131767726, 0.9941379571543596, -0.0434309150188675},
                {0.19686419516455167, 0.9766205557100867, -0.08635264226840306},
                {0.2924078244586765, 0.9476531711828025, -0.12826196374031534},
                {0.3845232393620468, 0.907575419670957, -0.16866753095840423},
                {0.47213047085684756, 0.8568571761675893, -0.2070956255902},
                {0.5542024042538579, 0.7960930657056438, -0.24309571336128688},
                {0.6297768211730822, 0.7259954919231308, -0.276245726157743},
                {0.697967680674491, 0.6473862847818277, -0.3061570103888757},
                {0.7579755072779274, 0.5611870653623823, -0.3324788835952228},
                {0.8090967640821455, 0.46840844069979015, -0.35490274587975823},
                {0.8507321010917264, 0.37013815533991434, -0.3731656979595285},
                {0.8823933820477846, 0.26752833852922075, -0.38705362341937466},
                {0.9037094073792955, 0.16178199655276462, -0.39640369903113126},
                {0.914430266178675, 0.05413890858541761, -0.40110630370710626},
                {0.914430266178675, -0.054138908585417485, -0.40110630370710626},
                {0.9037094073792955, -0.16178199655276473, -0.39640369903113126},
                {0.8823933820477845, -0.26752833852922087, -0.3870536234193746},
                {0.8507321010917264, -0.37013815533991445, -0.3731656979595285},
                {0.8090967640821455, -0.46840844069979004, -0.35490274587975823},
                {0.7579755072779274, -0.5611870653623823, -0.3324788835952228},
                {0.697967680674491, -0.6473862847818276, -0.3061570103888757},
                {0.6297768211730822, -0.7259954919231308, -0.276245726157743},
                {0.5542024042538579, -0.7960930657056438, -0.24309571336128688},
                {0.4721304708568475, -0.8568571761675893, -0.20709562559019995},
                {0.38452323936204663, -0.9075754196709571, -0.16866753095840417},
                {0.2924078244586763, -0.9476531711828025, -0.12826196374031526},
                {0.19686419516455184, -0.9766205557100867, -0.08635264226840313},
                {0.09901251317677275, -0.9941379571543596, -0.043430915018867554},
                {1.1214988732326398e-16, -1.0, -4.919350160333956e-17},
                {0.0, 1.0, -0.0},
                {0.07954574705300281, 0.9941379571543596, -0.07322701872079972},
                {0.15815889295117927, 0.9766205557100867, -0.14559551759919975},
                {0.23491777043555803, 0.9476531711828025, -0.2162570421530004},
                {0.3089224518489456, 0.907575419670957, -0.2843831506132563},
                {0.37930529996489565, 0.8568571761675893, -0.349175126646566},
                {0.4452411402409002, 0.7960930657056438, -0.40987334357380756},
                {0.5059569352354369, 0.7259954919231308, -0.465766170298418},
                {0.5607408477651756, 0.6473862847818277, -0.5161983145303501},
                {0.608950586545114, 0.5611870653623823, -0.5605785054890338},
                {0.6500209364666417, 0.46840844069979015, -0.5983864260126739},
                {0.6834703852279079, 0.37013815533991434, -0.629178812801242},
                {0.7089067686253095, 0.26752833852922075, -0.6525946532733903},
                {0.7260318683202189, 0.16178199655276462, -0.6683594181088894},
                {0.7346449081763414, 0.05413890858541761, -0.6762882798539055},
                {0.7346449081763414, -0.054138908585417485, -0.6762882798539055},
                {0.7260318683202189, -0.16178199655276473, -0.6683594181088894},
                {0.7089067686253094, -0.26752833852922087, -0.6525946532733902},
                {0.6834703852279079, -0.37013815533991445, -0.629178812801242},
                {0.6500209364666417, -0.46840844069979004, -0.5983864260126739},
                {0.608950586545114, -0.5611870653623823, -0.5605785054890338},
                {0.5607408477651756, -0.6473862847818276, -0.5161983145303501},
                {0.5059569352354369, -0.7259954919231308, -0.465766170298418},
                {0.4452411402409002, -0.7960930657056438, -0.40987334357380756},
                {0.37930529996489554, -0.8568571761675893, -0.34917512664656597},
                {0.3089224518489455, -0.9075754196709571, -0.2843831506132562},
                {0.23491777043555787, -0.9476531711828025, -0.21625704215300026},
                {0.1581588929511794, -0.9766205557100867, -0.14559551759919986},
                {0.07954574705300292, -0.9941379571543596, -0.07322701872079981},
                {9.01001932262024e-17, -1.0, -8.294307088129524e-17},
                {0.0, 1.0, -0.0},
                {0.051458964956602425, 0.9941379571543596, -0.09508783871006755},
                {0.10231462059846902, 0.9766205557100867, -0.1890608594508996},
                {0.1519707308609683, 0.9476531711828025, -0.2808173144746621},
                {0.199845123252287, 0.907575419670957, -0.36928144323992834},
                {0.24537651429361132, 0.8568571761675893, -0.45341608472044975},
                {0.28803109005472954, 0.7960930657056438, -0.5322348371699036},
                {0.3273087646342931, 0.7259954919231308, -0.6048136227804927},
                {0.362749043209777, 0.6473862847818277, -0.6703015216503493},
                {0.3939364209182393, 0.5611870653623823, -0.7279307480413812},
                {0.42050525427093977, 0.46840844069979015, -0.777025651965058},
                {0.4421440479889339, 0.37013815533991434, -0.817010640560773},
                {0.45859910700041606, 0.26752833852922075, -0.8474169263958654},
                {0.4696775107834804, 0.16178199655276462, -0.8678880235696508},
                {0.47524937518285176, 0.05413890858541761, -0.8781839271846693},
                {0.47524937518285176, -0.054138908585417485, -0.8781839271846693},
                {0.4696775107834804, -0.16178199655276473, -0.8678880235696508},
                {0.458599107000416, -0.26752833852922087, -0.8474169263958653},
                {0.4421440479889339, -0.37013815533991445, -0.817010640560773},
                {0.42050525427093977, -0.46840844069979004, -0.777025651965058},
                {0.3939364209182393, -0.5611870653623823, -0.7279307480413812},
                {0.362749043209777, -0.6473862847818276, -0.6703015216503493},
                {0.3273087646342931, -0.7259954919231308, -0.6048136227804927},
                {0.28803109005472954, -0.7960930657056438, -0.5322348371699036},
                {0.24537651429361126, -0.8568571761675893, -0.45341608472044964},
                {0.19984512325228693, -0.9075754196709571, -0.3692814432399282},
                {0.15197073086096818, -0.9476531711828025, -0.2808173144746619},
                {0.10231462059846912, -0.9766205557100867, -0.18906085945089976},
                {0.051458964956602495, -0.9941379571543596, -0.09508783871006769},
                {5.828674514453796e-17, -1.0, -1.0770447143491424e-16},
                {0.0, 1.0, -0.0},
                {0.01779580553904383, 0.9941379571543596, -0.10664441593526215},
                {0.03538297152900254, 0.9766205557100867, -0.2120385235996027},
                {0.05255530452874308, 0.9476531711828025, -0.3149466734434089},
                {0.06911147463465728, 0.907575419670957, -0.41416236149958063},
                {0.08485737588970396, 0.8568571761675893, -0.5085223745394281},
                {0.09960840199828254, 0.7960930657056438, -0.5969204276842417},
                {0.11319161066626171, 0.7259954919231308, -0.6783201345840093},
                {0.12544775119125554, 0.6473862847818277, -0.751767158099793},
                {0.13623313153150463, 0.5611870653623823, -0.816400399034124},
                {0.14542130296368683, 0.46840844069979015, -0.8714620917317831},
                {0.15290454257858505, 0.37013815533991434, -0.916306688189276},
                {0.15859511623370587, 0.26752833852922075, -0.9504084265149442},
                {0.16242630715588405, 0.16178199655276462, -0.9733674950064357},
                {0.16435319813444835, 0.05413890858541761, -0.9849147195773644},
                {0.16435319813444835, -0.054138908585417485, -0.9849147195773644},
                {0.16242630715588405, -0.16178199655276473, -0.9733674950064357},
                {0.15859511623370584, -0.26752833852922087, -0.9504084265149441},
                {0.15290454257858505, -0.37013815533991445, -0.916306688189276},
                {0.14542130296368683, -0.46840844069979004, -0.8714620917317831},
                {0.13623313153150463, -0.5611870653623823, -0.816400399034124},
                {0.12544775119125554, -0.6473862847818276, -0.751767158099793},
                {0.11319161066626171, -0.7259954919231308, -0.6783201345840093},
                {0.09960840199828254, -0.7960930657056438, -0.5969204276842417},
                {0.08485737588970395, -0.8568571761675893, -0.508522374539428},
                {0.06911147463465725, -0.9075754196709571, -0.41416236149958047},
                {0.05255530452874304, -0.9476531711828025, -0.31494667344340865},
                {0.03538297152900257, -0.9766205557100867, -0.21203852359960287},
                {0.017795805539043856, -0.9941379571543596, -0.1066444159352623},
                {2.01570238144271e-17, -1.0, -1.2079442130149551e-16},
                {-0.0, 1.0, -0.0},
                {-0.017795805539043804, 0.9941379571543596, -0.10664441593526217},
                {-0.03538297152900249, 0.9766205557100867, -0.2120385235996027},
                {-0.052555304528743, 0.9476531711828025, -0.3149466734434089},
                {-0.06911147463465717, 0.907575419670957, -0.4141623614995807},
                {-0.08485737588970384, 0.8568571761675893, -0.5085223745394282},
                {-0.09960840199828239, 0.7960930657056438, -0.5969204276842418},
                {-0.11319161066626153, 0.7259954919231308, -0.6783201345840094},
                {-0.12544775119125537, 0.6473862847818277, -0.7517671580997931},
                {-0.13623313153150443, 0.5611870653623823, -0.8164003990341241},
                {-0.1454213029636866, 0.46840844069979015, -0.8714620917317832},
                {-0.1529045425785848, 0.37013815533991434, -0.9163066881892761},
                {-0.15859511623370562, 0.26752833852922075, -0.9504084265149443},
                {-0.1624263071558838, 0.16178199655276462, -0.9733674950064358},
                {-0.1643531981344481, 0.05413890858541761, -0.9849147195773645},
                {-0.1643531981344481, -0.054138908585417485, -0.9849147195773645},
                {-0.1624263071558838, -0.16178199655276473, -0.9733674950064358},
                {-0.1585951162337056, -0.26752833852922087, -0.9504084265149442},
                {-0.1529045425785848, -0.37013815533991445, -0.9163066881892761},
                {-0.1454213029636866, -0.46840844069979004, -0.8714620917317832},
                {-0.13623313153150443, -0.5611870653623823, -0.8164003990341241},
                {-0.12544775119125537, -0.6473862847818276, -0.7517671580997931},
                {-0.11319161066626153, -0.7259954919231308, -0.6783201345840094},
                {-0.09960840199828239, -0.7960930657056438, -0.5969204276842418},
                {-0.08485737588970381, -0.8568571761675893, -0.5085223745394281},
                {-0.06911147463465714, -0.9075754196709571, -0.4141623614995805},
                {-0.05255530452874296, -0.9476531711828025, -0.31494667344340865},
                {-0.035382971529002515, -0.9766205557100867, -0.2120385235996029},
                {-0.01779580553904383, -0.9941379571543596, -0.10664441593526232},
                {-2.015702381442707e-17, -1.0, -1.2079442130149554e-16},
                {-0.0, 1.0, -0.0},
                {-0.0514589649566024, 0.9941379571543596, -0.09508783871006757},
                {-0.10231462059846898, 0.9766205557100867, -0.18906085945089962},
                {-0.15197073086096824, 0.9476531711828025, -0.2808173144746621},
                {-0.1998451232522869, 0.907575419670957, -0.3692814432399284},
                {-0.2453765142936112, 0.8568571761675893, -0.4534160847204498},
                {-0.2880310900547294, 0.7960930657056438, -0.5322348371699037},
                {-0.3273087646342929, 0.7259954919231308, -0.6048136227804927},
                {-0.36274904320977686, 0.6473862847818277, -0.6703015216503494},
                {-0.39393642091823916, 0.5611870653623823, -0.7279307480413814},
                {-0.4205052542709396, 0.46840844069979015, -0.7770256519650581},
                {-0.4421440479889337, 0.37013815533991434, -0.8170106405607731},
                {-0.45859910700041584, 0.26752833852922075, -0.8474169263958655},
                {-0.4696775107834802, 0.16178199655276462, -0.8678880235696509},
                {-0.47524937518285154, 0.05413890858541761, -0.8781839271846694},
                {-0.47524937518285154, -0.054138908585417485, -0.8781839271846694},
                {-0.4696775107834802, -0.16178199655276473, -0.8678880235696509},
                {-0.4585991070004158, -0.26752833852922087, -0.8474169263958654},
                {-0.4421440479889337, -0.37013815533991445, -0.8170106405607731},
                {-0.4205052542709396, -0.46840844069979004, -0.7770256519650581},
                {-0.39393642091823916, -0.5611870653623823, -0.7279307480413814},
                {-0.36274904320977686, -0.6473862847818276, -0.6703015216503494},
                {-0.3273087646342929, -0.7259954919231308, -0.6048136227804927},
                {-0.2880310900547294, -0.7960930657056438, -0.5322348371699037},
                {-0.24537651429361115, -0.8568571761675893, -0.4534160847204497},
                {-0.19984512325228682, -0.9075754196709571, -0.36928144323992823},
                {-0.15197073086096813, -0.9476531711828025, -0.28081731447466196},
                {-0.10231462059846906, -0.9766205557100867, -0.1890608594508998},
                {-0.051458964956602474, -0.9941379571543596, -0.0950878387100677},
                {-5.828674514453793e-17, -1.0, -1.0770447143491425e-16},
                {-0.0, 1.0, -0.0},
                {-0.07954574705300277, 0.9941379571543596, -0.07322701872079977},
                {-0.1581588929511792, 0.9766205557100867, -0.14559551759919986},
                {-0.2349177704355579, 0.9476531711828025, -0.21625704215300057},
                {-0.30892245184894546, 0.907575419670957, -0.2843831506132566},
                {-0.3793052999648954, 0.8568571761675893, -0.3491751266465663},
                {-0.44524114024089995, 0.7960930657056438, -0.4098733435738079},
                {-0.5059569352354366, 0.7259954919231308, -0.4657661702984184},
                {-0.5607408477651753, 0.6473862847818277, -0.5161983145303506},
                {-0.6089505865451137, 0.5611870653623823, -0.5605785054890342},
                {-0.6500209364666414, 0.46840844069979015, -0.5983864260126743},
                {-0.6834703852279075, 0.37013815533991434, -0.6291788128012425},
                {-0.7089067686253091, 0.26752833852922075, -0.6525946532733907},
                {-0.7260318683202185, 0.16178199655276462, -0.66835941810889},
                {-0.734644908176341, 0.05413890858541761, -0.676288279853906},
                {-0.734644908176341, -0.054138908585417485, -0.676288279853906},
                {-0.7260318683202185, -0.16178199655276473, -0.66835941810889},
                {-0.708906768625309, -0.26752833852922087, -0.6525946532733907},
                {-0.6834703852279075, -0.37013815533991445, -0.6291788128012425},
                {-0.6500209364666414, -0.46840844069979004, -0.5983864260126743},
                {-0.6089505865451137, -0.5611870653623823, -0.5605785054890342},
                {-0.5607408477651753, -0.6473862847818276, -0.5161983145303506},
                {-0.5059569352354366, -0.7259954919231308, -0.4657661702984184},
                {-0.44524114024089995, -0.7960930657056438, -0.4098733435738079},
                {-0.3793052999648953, -0.8568571761675893, -0.34917512664656625},
                {-0.30892245184894535, -0.9075754196709571, -0.2843831506132565},
                {-0.23491777043555773, -0.9476531711828025, -0.21625704215300043},
                {-0.15815889295117933, -0.9766205557100867, -0.1455955175992},
                {-0.07954574705300288, -0.9941379571543596, -0.07322701872079988},
                {-9.010019322620234e-17, -1.0, -8.294307088129531e-17},
                {-0.0, 1.0, -0.0},
                {-0.09901251317677258, 0.9941379571543596, -0.04343091501886756},
                {-0.19686419516455161, 0.9766205557100867, -0.08635264226840318},
                {-0.2924078244586764, 0.9476531711828025, -0.12826196374031554},
                {-0.38452323936204674, 0.907575419670957, -0.16866753095840448},
                {-0.47213047085684745, 0.8568571761675893, -0.2070956255902003},
                {-0.5542024042538578, 0.7960930657056438, -0.24309571336128724},
                {-0.6297768211730821, 0.7259954919231308, -0.2762457261577434},
                {-0.6979676806744908, 0.6473862847818277, -0.30615701038887616},
                {-0.7579755072779273, 0.5611870653623823, -0.3324788835952234},
                {-0.8090967640821453, 0.46840844069979015, -0.3549027458797588},
                {-0.8507321010917261, 0.37013815533991434, -0.37316569795952903},
                {-0.8823933820477844, 0.26752833852922075, -0.3870536234193752},
                {-0.9037094073792953, 0.16178199655276462, -0.3964036990311319},
                {-0.9144302661786747, 0.05413890858541761, -0.40110630370710687},
                {-0.9144302661786747, -0.054138908585417485, -0.40110630370710687},
                {-0.9037094073792953, -0.16178199655276473, -0.3964036990311319},
                {-0.8823933820477843, -0.26752833852922087, -0.38705362341937516},
                {-0.8507321010917261, -0.37013815533991445, -0.37316569795952903},
                {-0.8090967640821453, -0.46840844069979004, -0.3549027458797588},
                {-0.7579755072779273, -0.5611870653623823, -0.3324788835952234},
                {-0.6979676806744908, -0.6473862847818276, -0.30615701038887616},
                {-0.6297768211730821, -0.7259954919231308, -0.2762457261577434},
                {-0.5542024042538578, -0.7960930657056438, -0.24309571336128724},
                {-0.4721304708568474, -0.8568571761675893, -0.20709562559020028},
                {-0.3845232393620466, -0.9075754196709571, -0.16866753095840442},
                {-0.29240782445867625, -0.9476531711828025, -0.12826196374031545},
                {-0.19686419516455178, -0.9766205557100867, -0.08635264226840327},
                {-0.09901251317677272, -0.9941379571543596, -0.04343091501886762},
                {-1.1214988732326395e-16, -1.0, -4.9193501603339633e-17},
                {-0.0, 1.0, -0.0},
                {-0.1077497371604028, 0.9941379571543596, -0.008928397774560197},
                {-0.21423620716912406, 0.9766205557100867, -0.017752118248525607},
                {-0.31821095352681955, 0.9476531711828025, -0.026367711366943557},
                {-0.4184549673974624, 0.907575419670957, -0.0346741671778125},
                {-0.5137929793723953, 0.8568571761675893, -0.04257410008141497},
                {-0.6031072384295877, 0.7960930657056438, -0.04997489058743377},
                {-0.6853506165423999, 0.7259954919231308, -0.05678977119379311},
                {-0.7595588852982972, 0.6473862847818277, -0.0629388436562882},
                {-0.8248620205953833, 0.5611870653623823, -0.06835001572244684},
                {-0.8804944028795261, 0.46840844069979015, -0.07295984634727513},
                {-0.9258037933336163, 0.37013815533991434, -0.07671428948150527},
                {-0.9602589807813504, 0.26752833852922075, -0.07956932771210855},
                {-0.9834560096525818, 0.16178199655276462, -0.08149148832621744},
                {-0.9951229159930415, 0.05413890858541761, -0.08245823574807976},
                {-0.9951229159930415, -0.054138908585417485, -0.08245823574807976},
                {-0.9834560096525818, -0.16178199655276473, -0.08149148832621744},
                {-0.9602589807813503, -0.26752833852922087, -0.07956932771210853},
                {-0.9258037933336163, -0.37013815533991445, -0.07671428948150527},
                {-0.8804944028795261, -0.46840844069979004, -0.07295984634727513},
                {-0.8248620205953833, -0.5611870653623823, -0.06835001572244684},
                {-0.7595588852982972, -0.6473862847818276, -0.0629388436562882},
                {-0.6853506165423999, -0.7259954919231308, -0.05678977119379311},
                {-0.6031072384295877, -0.7960930657056438, -0.04997489058743377},
                {-0.5137929793723952, -0.8568571761675893, -0.04257410008141496},
                {-0.41845496739746224, -0.9075754196709571, -0.034674167177812486},
                {-0.31821095352681933, -0.9476531711828025, -0.026367711366943537},
                {-0.21423620716912425, -0.9766205557100867, -0.017752118248525624},
                {-0.10774973716040295, -0.9941379571543596, -0.008928397774560209},
                {-1.2204640094405062e-16, -1.0, -1.0113053110837577e-17},
                {-0.0, 1.0, 0.0},
                {-0.10481060521326853, 0.9941379571543596, 0.026541649906986344},
                {-0.20839240190966168, 0.9766205557100867, 0.052772123236075205},
                {-0.30953098822865416, 0.9476531711828025, 0.07838389167023349},
                {-0.40704060671754705, 0.907575419670957, 0.10307668064163389},
                {-0.49977804625345246, 0.8568571761675893, 0.126560989776419},
                {-0.5866560451484615, 0.7960930657056438, 0.14856148702189204},
                {-0.6666560382988421, 0.7259954919231308, 0.1688202366630963},
                {-0.7388400989295975, 0.6473862847818277, 0.18709972338324019},
                {-0.8023619349283477, 0.5611870653623823, 0.20318563691362398},
                {-0.8564768108465762, 0.46840844069979015, 0.216889384625595},
                {-0.9005502792418445, 0.37013815533991434, 0.22805030260668638},
                {-0.9340656189939747, 0.26752833852922075, 0.23653753929809448},
                {-0.9566298933877402, 0.16178199655276462, 0.242251589609567},
                {-0.967978556936587, 0.05413890858541761, 0.24512546152560796},
                {-0.967978556936587, -0.054138908585417485, 0.24512546152560796},
                {-0.9566298933877402, -0.16178199655276473, 0.242251589609567},
                {-0.9340656189939746, -0.26752833852922087, 0.23653753929809446},
                {-0.9005502792418445, -0.37013815533991445, 0.22805030260668638},
                {-0.8564768108465762, -0.46840844069979004, 0.216889384625595},
                {-0.8023619349283477, -0.5611870653623823, 0.20318563691362398},
                {-0.7388400989295975, -0.6473862847818276, 0.18709972338324019},
                {-0.6666560382988421, -0.7259954919231308, 0.1688202366630963},
                {-0.5866560451484615, -0.7960930657056438, 0.14856148702189204},
                {-0.49977804625345235, -0.8568571761675893, 0.12656098977641897},
                {-0.4070406067175469, -0.9075754196709571, 0.10307668064163385},
                {-0.30953098822865394, -0.9476531711828025, 0.07838389167023345},
                {-0.20839240190966188, -0.9766205557100867, 0.052772123236075254},
                {-0.10481060521326867, -0.9941379571543596, 0.026541649906986382},
                {-1.187172932775194e-16, -1.0, 3.0063301606410795e-17},
                {-0.0, 1.0, 0.0},
                {-0.0905136178871728, 0.9941379571543596, 0.059135497984979656},
                {-0.17996604636200852, 0.9766205557100867, 0.11757768632418684},
                {-0.26730853748777506, 0.9476531711828025, 0.17464138379354674},
                {-0.35151708041402396, 0.907575419670957, 0.22965757071406723},
                {-0.43160440696755004, 0.8568571761675893, 0.2819812325958846},
                {-0.506631566469054, 0.7960930657056438, 0.3309989223434149},
                {-0.5757189340713671, 0.7259954919231308, 0.3761359523616693},
                {-0.6380565235565347, 0.6473862847818277, 0.41686313224286414},
                {-0.6929134836836447, 0.5611870653623823, 0.4527029730401078},
                {-0.7396466667514038, 0.46840844069979015, 0.48323528538873173},
                {-0.7777081689168992, 0.37013815533991434, 0.5081021058424076},
                {-0.8066517538672039, 0.26752833852922075, 0.527011893667267},
                {-0.8261380845321474, 0.16178199655276462, 0.539742948890447},
                {-0.8359387015012055, 0.05413890858541761, 0.5461460115295709},
                {-0.8359387015012055, -0.054138908585417485, 0.5461460115295709},
                {-0.8261380845321474, -0.16178199655276473, 0.539742948890447},
                {-0.8066517538672038, -0.26752833852922087, 0.5270118936672669},
                {-0.7777081689168992, -0.37013815533991445, 0.5081021058424076},
                {-0.7396466667514038, -0.46840844069979004, 0.48323528538873173},
                {-0.6929134836836447, -0.5611870653623823, 0.4527029730401078},
                {-0.6380565235565347, -0.6473862847818276, 0.41686313224286414},
                {-0.5757189340713671, -0.7259954919231308, 0.3761359523616693},
                {-0.506631566469054, -0.7960930657056438, 0.3309989223434149},
                {-0.4316044069675499, -0.8568571761675893, 0.28198123259588453},
                {-0.35151708041402385, -0.9075754196709571, 0.22965757071406714},
                {-0.2673085374877749, -0.9476531711828025, 0.17464138379354663},
                {-0.1799660463620087, -0.9766205557100867, 0.11757768632418696},
                {-0.09051361788717292, -0.9941379571543596, 0.05913549798497974},
                {-1.0252332479576681e-16, -1.0, 6.698183111441702e-17},
                {-0.0, 1.0, 0.0},
                {-0.06640807559951346, 0.9941379571543596, 0.08532109727450744},
                {-0.1320375772301052, 0.9766205557100867, 0.16964188269329444},
                {-0.19611905899078208, 0.9476531711828025, 0.2519737721425551},
                {-0.25790122409815763, 0.907575419670957, 0.33135149949526116},
                {-0.3166597331543202, 0.8568571761675893, 0.4068444334739504},
                {-0.3717056963640034, 0.7960930657056438, 0.4775674884515704},
                {-0.4223937501375778, 0.7259954919231308, 0.5426915012712145},
                {-0.46812962338907793, 0.6473862847818277, 0.601452952426025},
                {-0.5083771048213374, 0.5611870653623823, 0.6531629176273192},
                {-0.5426643295131863, 0.46840844069979015, 0.6972151448119834},
                {-0.5705893111042212, 0.37013815533991434, 0.7330931618936134},
                {-0.5918246547173414, 0.26752833852922075, 0.7603763319255107},
                {-0.6061213953643426, 0.16178199655276462, 0.7787447846842914},
                {-0.6133119168327738, 0.05413890858541761, 0.7879831668557955},
                {-0.6133119168327738, -0.054138908585417485, 0.7879831668557955},
                {-0.6061213953643426, -0.16178199655276473, 0.7787447846842914},
                {-0.5918246547173412, -0.26752833852922087, 0.7603763319255106},
                {-0.5705893111042212, -0.37013815533991445, 0.7330931618936134},
                {-0.5426643295131863, -0.46840844069979004, 0.6972151448119834},
                {-0.5083771048213374, -0.5611870653623823, 0.6531629176273192},
                {-0.46812962338907793, -0.6473862847818276, 0.601452952426025},
                {-0.4223937501375778, -0.7259954919231308, 0.5426915012712145},
                {-0.3717056963640034, -0.7960930657056438, 0.4775674884515704},
                {-0.3166597331543201, -0.8568571761675893, 0.4068444334739503},
                {-0.2579012240981575, -0.9075754196709571, 0.331351499495261},
                {-0.19611905899078194, -0.9476531711828025, 0.25197377214255495},
                {-0.1320375772301053, -0.9766205557100867, 0.1696418826932946},
                {-0.06640807559951356, -0.9941379571543596, 0.08532109727450757},
                {-7.521936325910148e-17, -1.0, 9.664183989098049e-17},
                {-0.0, 1.0, 0.0},
                {-0.035106187893185314, 0.9941379571543596, 0.1022608317811127},
                {-0.06980078783121671, 0.9766205557100867, 0.203322748807562},
                {-0.10367703735139604, 0.9476531711828025, 0.3020008925040047},
                {-0.13633776840144946, 0.907575419670957, 0.3971383518578871},
                {-0.16740006377180627, 0.8568571761675893, 0.48761972714329366},
                {-0.19649974644977658, 0.7960930657056438, 0.5723842069629133},
                {-0.22329564926205475, 0.7259954919231308, 0.6504380052917639},
                {-0.24747361474789445, 0.6473862847818277, 0.7208660127097082},
                {-0.26875017836809884, 0.5611870653623823, 0.7828425252227119},
                {-0.28687589186756857, 0.46840844069979015, 0.835640924887226},
                {-0.3016382478280204, 0.37013815533991434, 0.878642198741221},
                {-0.3128641711231687, 0.26752833852922075, 0.9113421961651986},
                {-0.3204220480663374, 0.16178199655276462, 0.9333575395872554},
                {-0.3242232694606007, 0.05413890858541761, 0.9444301192345882},
                {-0.3242232694606007, -0.054138908585417485, 0.9444301192345882},
                {-0.3204220480663374, -0.16178199655276473, 0.9333575395872554},
                {-0.31286417112316867, -0.26752833852922087, 0.9113421961651985},
                {-0.3016382478280204, -0.37013815533991445, 0.878642198741221},
                {-0.28687589186756857, -0.46840844069979004, 0.835640924887226},
                {-0.26875017836809884, -0.5611870653623823, 0.7828425252227119},
                {-0.24747361474789445, -0.6473862847818276, 0.7208660127097082},
                {-0.22329564926205475, -0.7259954919231308, 0.6504380052917639},
                {-0.19649974644977658, -0.7960930657056438, 0.5723842069629133},
                {-0.16740006377180625, -0.8568571761675893, 0.48761972714329355},
                {-0.1363377684014494, -0.9075754196709571, 0.39713835185788693},
                {-0.10367703735139597, -0.9476531711828025, 0.30200089250400447},
                {-0.06980078783121678, -0.9766205557100867, 0.20332274880756215},
                {-0.03510618789318536, -0.9941379571543596, 0.10226083178111285},
                {-3.9764216564636053e-17, -1.0, 1.1582920576270607e-16},
                {-0.0, 1.0, 0.0},
                {-2.64815219679668e-17, 0.9941379571543596, 0.10811901842394177},
                {-5.265257230314562e-17, 0.9766205557100867, 0.21497044021102407},
                {-7.820631936877601e-17, 0.9476531711828025, 0.31930153013598},
                {-1.0284316884452719e-16, 0.907575419670957, 0.4198891015602646},
                {-1.2627427619598228e-16, 0.8568571761675893, 0.5155538571770217},
                {-1.482249331127112e-16, 0.7960930657056438, 0.6051742151937651},
                {-1.6843778821204233e-16, 0.7259954919231308, 0.6876994588534232},
                {-1.8667586424872572e-16, 0.6473862847818277, 0.7621620551276365},
                {-2.027253364564631e-16, 0.5611870653623823, 0.8276889981568906},
                {-2.163980394477912e-16, 0.46840844069979015, 0.8835120444460229},
                {-2.275336732812082e-16, 0.37013815533991434, 0.9289767198167914},
                {-2.360016828314245e-16, 0.26752833852922075, 0.963549992519223},
                {-2.4170278842883866e-16, 0.16178199655276462, 0.9868265225415261},
                {-2.4457014982289163e-16, 0.05413890858541761, 0.9985334138511238},
                {-2.4457014982289163e-16, -0.054138908585417485, 0.9985334138511238},
                {-2.4170278842883866e-16, -0.16178199655276473, 0.9868265225415261},
                {-2.360016828314245e-16, -0.26752833852922087, 0.9635499925192229},
                {-2.275336732812082e-16, -0.37013815533991445, 0.9289767198167914},
                {-2.163980394477912e-16, -0.46840844069979004, 0.8835120444460229},
                {-2.027253364564631e-16, -0.5611870653623823, 0.8276889981568906},
                {-1.8667586424872572e-16, -0.6473862847818276, 0.7621620551276365},
                {-1.6843778821204233e-16, -0.7259954919231308, 0.6876994588534232},
                {-1.482249331127112e-16, -0.7960930657056438, 0.6051742151937651},
                {-1.2627427619598225e-16, -0.8568571761675893, 0.5155538571770216},
                {-1.0284316884452715e-16, -0.9075754196709571, 0.41988910156026443},
                {-7.820631936877595e-17, -0.9476531711828025, 0.3193015301359798},
                {-5.2652572303145667e-17, -0.9766205557100867, 0.21497044021102427},
                {-2.6481521967966837e-17, -0.9941379571543596, 0.10811901842394192},
                {-2.999519565323715e-32, -1.0, 1.2246467991473532e-16},
            };
        private readonly int[,] sphereEdges = new int[599, 3]
            {
                {0, 1, 0},
                {1, 2, 0},
                {2, 3, 0},
                {3, 4, 0},
                {4, 5, 0},
                {5, 6, 0},
                {6, 7, 0},
                {7, 8, 0},
                {8, 9, 0},
                {9, 10, 0},
                {10, 11, 0},
                {11, 12, 0},
                {12, 13, 0},
                {13, 14, 0},
                {14, 15, 0},
                {15, 16, 0},
                {16, 17, 0},
                {17, 18, 0},
                {18, 19, 0},
                {19, 20, 0},
                {20, 21, 0},
                {21, 22, 0},
                {22, 23, 0},
                {23, 24, 0},
                {24, 25, 0},
                {25, 26, 0},
                {26, 27, 0},
                {27, 28, 0},
                {28, 29, 0},
                {29, 30, 0},
                {30, 31, 0},
                {31, 32, 0},
                {32, 33, 0},
                {33, 34, 0},
                {34, 35, 0},
                {35, 36, 0},
                {36, 37, 0},
                {37, 38, 0},
                {38, 39, 0},
                {39, 40, 0},
                {40, 41, 0},
                {41, 42, 0},
                {42, 43, 0},
                {43, 44, 0},
                {44, 45, 0},
                {45, 46, 0},
                {46, 47, 0},
                {47, 48, 0},
                {48, 49, 0},
                {49, 50, 0},
                {50, 51, 0},
                {51, 52, 0},
                {52, 53, 0},
                {53, 54, 0},
                {54, 55, 0},
                {55, 56, 0},
                {56, 57, 0},
                {57, 58, 0},
                {58, 59, 0},
                {59, 60, 0},
                {60, 61, 0},
                {61, 62, 0},
                {62, 63, 0},
                {63, 64, 0},
                {64, 65, 0},
                {65, 66, 0},
                {66, 67, 0},
                {67, 68, 0},
                {68, 69, 0},
                {69, 70, 0},
                {70, 71, 0},
                {71, 72, 0},
                {72, 73, 0},
                {73, 74, 0},
                {74, 75, 0},
                {75, 76, 0},
                {76, 77, 0},
                {77, 78, 0},
                {78, 79, 0},
                {79, 80, 0},
                {80, 81, 0},
                {81, 82, 0},
                {82, 83, 0},
                {83, 84, 0},
                {84, 85, 0},
                {85, 86, 0},
                {86, 87, 0},
                {87, 88, 0},
                {88, 89, 0},
                {89, 90, 0},
                {90, 91, 0},
                {91, 92, 0},
                {92, 93, 0},
                {93, 94, 0},
                {94, 95, 0},
                {95, 96, 0},
                {96, 97, 0},
                {97, 98, 0},
                {98, 99, 0},
                {99, 100, 0},
                {100, 101, 0},
                {101, 102, 0},
                {102, 103, 0},
                {103, 104, 0},
                {104, 105, 0},
                {105, 106, 0},
                {106, 107, 0},
                {107, 108, 0},
                {108, 109, 0},
                {109, 110, 0},
                {110, 111, 0},
                {111, 112, 0},
                {112, 113, 0},
                {113, 114, 0},
                {114, 115, 0},
                {115, 116, 0},
                {116, 117, 0},
                {117, 118, 0},
                {118, 119, 0},
                {119, 120, 0},
                {120, 121, 0},
                {121, 122, 0},
                {122, 123, 0},
                {123, 124, 0},
                {124, 125, 0},
                {125, 126, 0},
                {126, 127, 0},
                {127, 128, 0},
                {128, 129, 0},
                {129, 130, 0},
                {130, 131, 0},
                {131, 132, 0},
                {132, 133, 0},
                {133, 134, 0},
                {134, 135, 0},
                {135, 136, 0},
                {136, 137, 0},
                {137, 138, 0},
                {138, 139, 0},
                {139, 140, 0},
                {140, 141, 0},
                {141, 142, 0},
                {142, 143, 0},
                {143, 144, 0},
                {144, 145, 0},
                {145, 146, 0},
                {146, 147, 0},
                {147, 148, 0},
                {148, 149, 0},
                {149, 150, 0},
                {150, 151, 0},
                {151, 152, 0},
                {152, 153, 0},
                {153, 154, 0},
                {154, 155, 0},
                {155, 156, 0},
                {156, 157, 0},
                {157, 158, 0},
                {158, 159, 0},
                {159, 160, 0},
                {160, 161, 0},
                {161, 162, 0},
                {162, 163, 0},
                {163, 164, 0},
                {164, 165, 0},
                {165, 166, 0},
                {166, 167, 0},
                {167, 168, 0},
                {168, 169, 0},
                {169, 170, 0},
                {170, 171, 0},
                {171, 172, 0},
                {172, 173, 0},
                {173, 174, 0},
                {174, 175, 0},
                {175, 176, 0},
                {176, 177, 0},
                {177, 178, 0},
                {178, 179, 0},
                {179, 180, 0},
                {180, 181, 0},
                {181, 182, 0},
                {182, 183, 0},
                {183, 184, 0},
                {184, 185, 0},
                {185, 186, 0},
                {186, 187, 0},
                {187, 188, 0},
                {188, 189, 0},
                {189, 190, 0},
                {190, 191, 0},
                {191, 192, 0},
                {192, 193, 0},
                {193, 194, 0},
                {194, 195, 0},
                {195, 196, 0},
                {196, 197, 0},
                {197, 198, 0},
                {198, 199, 0},
                {199, 200, 0},
                {200, 201, 0},
                {201, 202, 0},
                {202, 203, 0},
                {203, 204, 0},
                {204, 205, 0},
                {205, 206, 0},
                {206, 207, 0},
                {207, 208, 0},
                {208, 209, 0},
                {209, 210, 0},
                {210, 211, 0},
                {211, 212, 0},
                {212, 213, 0},
                {213, 214, 0},
                {214, 215, 0},
                {215, 216, 0},
                {216, 217, 0},
                {217, 218, 0},
                {218, 219, 0},
                {219, 220, 0},
                {220, 221, 0},
                {221, 222, 0},
                {222, 223, 0},
                {223, 224, 0},
                {224, 225, 0},
                {225, 226, 0},
                {226, 227, 0},
                {227, 228, 0},
                {228, 229, 0},
                {229, 230, 0},
                {230, 231, 0},
                {231, 232, 0},
                {232, 233, 0},
                {233, 234, 0},
                {234, 235, 0},
                {235, 236, 0},
                {236, 237, 0},
                {237, 238, 0},
                {238, 239, 0},
                {239, 240, 0},
                {240, 241, 0},
                {241, 242, 0},
                {242, 243, 0},
                {243, 244, 0},
                {244, 245, 0},
                {245, 246, 0},
                {246, 247, 0},
                {247, 248, 0},
                {248, 249, 0},
                {249, 250, 0},
                {250, 251, 0},
                {251, 252, 0},
                {252, 253, 0},
                {253, 254, 0},
                {254, 255, 0},
                {255, 256, 0},
                {256, 257, 0},
                {257, 258, 0},
                {258, 259, 0},
                {259, 260, 0},
                {260, 261, 0},
                {261, 262, 0},
                {262, 263, 0},
                {263, 264, 0},
                {264, 265, 0},
                {265, 266, 0},
                {266, 267, 0},
                {267, 268, 0},
                {268, 269, 0},
                {269, 270, 0},
                {270, 271, 0},
                {271, 272, 0},
                {272, 273, 0},
                {273, 274, 0},
                {274, 275, 0},
                {275, 276, 0},
                {276, 277, 0},
                {277, 278, 0},
                {278, 279, 0},
                {279, 280, 0},
                {280, 281, 0},
                {281, 282, 0},
                {282, 283, 0},
                {283, 284, 0},
                {284, 285, 0},
                {285, 286, 0},
                {286, 287, 0},
                {287, 288, 0},
                {288, 289, 0},
                {289, 290, 0},
                {290, 291, 0},
                {291, 292, 0},
                {292, 293, 0},
                {293, 294, 0},
                {294, 295, 0},
                {295, 296, 0},
                {296, 297, 0},
                {297, 298, 0},
                {298, 299, 0},
                {299, 300, 0},
                {300, 301, 0},
                {301, 302, 0},
                {302, 303, 0},
                {303, 304, 0},
                {304, 305, 0},
                {305, 306, 0},
                {306, 307, 0},
                {307, 308, 0},
                {308, 309, 0},
                {309, 310, 0},
                {310, 311, 0},
                {311, 312, 0},
                {312, 313, 0},
                {313, 314, 0},
                {314, 315, 0},
                {315, 316, 0},
                {316, 317, 0},
                {317, 318, 0},
                {318, 319, 0},
                {319, 320, 0},
                {320, 321, 0},
                {321, 322, 0},
                {322, 323, 0},
                {323, 324, 0},
                {324, 325, 0},
                {325, 326, 0},
                {326, 327, 0},
                {327, 328, 0},
                {328, 329, 0},
                {329, 330, 0},
                {330, 331, 0},
                {331, 332, 0},
                {332, 333, 0},
                {333, 334, 0},
                {334, 335, 0},
                {335, 336, 0},
                {336, 337, 0},
                {337, 338, 0},
                {338, 339, 0},
                {339, 340, 0},
                {340, 341, 0},
                {341, 342, 0},
                {342, 343, 0},
                {343, 344, 0},
                {344, 345, 0},
                {345, 346, 0},
                {346, 347, 0},
                {347, 348, 0},
                {348, 349, 0},
                {349, 350, 0},
                {350, 351, 0},
                {351, 352, 0},
                {352, 353, 0},
                {353, 354, 0},
                {354, 355, 0},
                {355, 356, 0},
                {356, 357, 0},
                {357, 358, 0},
                {358, 359, 0},
                {359, 360, 0},
                {360, 361, 0},
                {361, 362, 0},
                {362, 363, 0},
                {363, 364, 0},
                {364, 365, 0},
                {365, 366, 0},
                {366, 367, 0},
                {367, 368, 0},
                {368, 369, 0},
                {369, 370, 0},
                {370, 371, 0},
                {371, 372, 0},
                {372, 373, 0},
                {373, 374, 0},
                {374, 375, 0},
                {375, 376, 0},
                {376, 377, 0},
                {377, 378, 0},
                {378, 379, 0},
                {379, 380, 0},
                {380, 381, 0},
                {381, 382, 0},
                {382, 383, 0},
                {383, 384, 0},
                {384, 385, 0},
                {385, 386, 0},
                {386, 387, 0},
                {387, 388, 0},
                {388, 389, 0},
                {389, 390, 0},
                {390, 391, 0},
                {391, 392, 0},
                {392, 393, 0},
                {393, 394, 0},
                {394, 395, 0},
                {395, 396, 0},
                {396, 397, 0},
                {397, 398, 0},
                {398, 399, 0},
                {399, 400, 0},
                {400, 401, 0},
                {401, 402, 0},
                {402, 403, 0},
                {403, 404, 0},
                {404, 405, 0},
                {405, 406, 0},
                {406, 407, 0},
                {407, 408, 0},
                {408, 409, 0},
                {409, 410, 0},
                {410, 411, 0},
                {411, 412, 0},
                {412, 413, 0},
                {413, 414, 0},
                {414, 415, 0},
                {415, 416, 0},
                {416, 417, 0},
                {417, 418, 0},
                {418, 419, 0},
                {419, 420, 0},
                {420, 421, 0},
                {421, 422, 0},
                {422, 423, 0},
                {423, 424, 0},
                {424, 425, 0},
                {425, 426, 0},
                {426, 427, 0},
                {427, 428, 0},
                {428, 429, 0},
                {429, 430, 0},
                {430, 431, 0},
                {431, 432, 0},
                {432, 433, 0},
                {433, 434, 0},
                {434, 435, 0},
                {435, 436, 0},
                {436, 437, 0},
                {437, 438, 0},
                {438, 439, 0},
                {439, 440, 0},
                {440, 441, 0},
                {441, 442, 0},
                {442, 443, 0},
                {443, 444, 0},
                {444, 445, 0},
                {445, 446, 0},
                {446, 447, 0},
                {447, 448, 0},
                {448, 449, 0},
                {449, 450, 0},
                {450, 451, 0},
                {451, 452, 0},
                {452, 453, 0},
                {453, 454, 0},
                {454, 455, 0},
                {455, 456, 0},
                {456, 457, 0},
                {457, 458, 0},
                {458, 459, 0},
                {459, 460, 0},
                {460, 461, 0},
                {461, 462, 0},
                {462, 463, 0},
                {463, 464, 0},
                {464, 465, 0},
                {465, 466, 0},
                {466, 467, 0},
                {467, 468, 0},
                {468, 469, 0},
                {469, 470, 0},
                {470, 471, 0},
                {471, 472, 0},
                {472, 473, 0},
                {473, 474, 0},
                {474, 475, 0},
                {475, 476, 0},
                {476, 477, 0},
                {477, 478, 0},
                {478, 479, 0},
                {479, 480, 0},
                {480, 481, 0},
                {481, 482, 0},
                {482, 483, 0},
                {483, 484, 0},
                {484, 485, 0},
                {485, 486, 0},
                {486, 487, 0},
                {487, 488, 0},
                {488, 489, 0},
                {489, 490, 0},
                {490, 491, 0},
                {491, 492, 0},
                {492, 493, 0},
                {493, 494, 0},
                {494, 495, 0},
                {495, 496, 0},
                {496, 497, 0},
                {497, 498, 0},
                {498, 499, 0},
                {499, 500, 0},
                {500, 501, 0},
                {501, 502, 0},
                {502, 503, 0},
                {503, 504, 0},
                {504, 505, 0},
                {505, 506, 0},
                {506, 507, 0},
                {507, 508, 0},
                {508, 509, 0},
                {509, 510, 0},
                {510, 511, 0},
                {511, 512, 0},
                {512, 513, 0},
                {513, 514, 0},
                {514, 515, 0},
                {515, 516, 0},
                {516, 517, 0},
                {517, 518, 0},
                {518, 519, 0},
                {519, 520, 0},
                {520, 521, 0},
                {521, 522, 0},
                {522, 523, 0},
                {523, 524, 0},
                {524, 525, 0},
                {525, 526, 0},
                {526, 527, 0},
                {527, 528, 0},
                {528, 529, 0},
                {529, 530, 0},
                {530, 531, 0},
                {531, 532, 0},
                {532, 533, 0},
                {533, 534, 0},
                {534, 535, 0},
                {535, 536, 0},
                {536, 537, 0},
                {537, 538, 0},
                {538, 539, 0},
                {539, 540, 0},
                {540, 541, 0},
                {541, 542, 0},
                {542, 543, 0},
                {543, 544, 0},
                {544, 545, 0},
                {545, 546, 0},
                {546, 547, 0},
                {547, 548, 0},
                {548, 549, 0},
                {549, 550, 0},
                {550, 551, 0},
                {551, 552, 0},
                {552, 553, 0},
                {553, 554, 0},
                {554, 555, 0},
                {555, 556, 0},
                {556, 557, 0},
                {557, 558, 0},
                {558, 559, 0},
                {559, 560, 0},
                {560, 561, 0},
                {561, 562, 0},
                {562, 563, 0},
                {563, 564, 0},
                {564, 565, 0},
                {565, 566, 0},
                {566, 567, 0},
                {567, 568, 0},
                {568, 569, 0},
                {569, 570, 0},
                {570, 571, 0},
                {571, 572, 0},
                {572, 573, 0},
                {573, 574, 0},
                {574, 575, 0},
                {575, 576, 0},
                {576, 577, 0},
                {577, 578, 0},
                {578, 579, 0},
                {579, 580, 0},
                {580, 581, 0},
                {581, 582, 0},
                {582, 583, 0},
                {583, 584, 0},
                {584, 585, 0},
                {585, 586, 0},
                {586, 587, 0},
                {587, 588, 0},
                {588, 589, 0},
                {589, 590, 0},
                {590, 591, 0},
                {591, 592, 0},
                {592, 593, 0},
                {593, 594, 0},
                {594, 595, 0},
                {595, 596, 0},
                {596, 597, 0},
                {597, 598, 0},
                {598, 599, 0},
            };  

        private float[,] render;

        private double focalLength = 1D;
        private double angle = 0;
        private double angleDelta = 0.0002;
        private double xOffset, yOffset, zOffset;
        private Boolean showCircles;
        private Boolean doAutoRotate;
        private int fps = 120;

        private Bitmap canvas = new Bitmap(600, 600);
        private Pen blackPen = new Pen(Brushes.Black, 3);
        private Pen redPen = new Pen(Brushes.Red, 3);
        private Pen bluePen = new Pen(Brushes.Blue, 3);
        private Pen[] pens;

        public Form1()
        {
            InitializeComponent();

            pens = new Pen[] { blackPen, redPen, bluePen };

            Timer tmr = new Timer();
            tmr.Interval = (int)1000 / fps;
            tmr.Tick += Frame;
            tmr.Start();

            this.DropdownMesh.Text = "Cube";
        }


        private void ButtonResetRotateModel_Click(object sender, EventArgs e)
        {
            TrackBarRotateModel.Value = 0;
            angle = 20D;
            this.autoRotate.Checked = false;
        }

        private void checkBoxShowCorners_CheckedChanged(object sender, EventArgs e)
        {
            showCircles = !showCircles;
        }
        private void autoRotate_CheckedChanged(object sender, EventArgs e)
        {
            doAutoRotate = !doAutoRotate;
        }

        private void NumericUpDownX_ValueChanged(object sender, EventArgs e)
        {
            xOffset = (double)this.NumericUpDownX.Value;
        }

        private void NumericUpDownY_ValueChanged(object sender, EventArgs e)
        {
            yOffset = (double)this.NumericUpDownY.Value;
        }

        private void NumericUpDownZ_ValueChanged(object sender, EventArgs e)
        {
            zOffset = (double)this.NumericUpDownZ.Value;
        }

        private void NumericUpDownFocalLength_ValueChanged(object sender, EventArgs e)
        {
            focalLength = (double)this.NumericUpDownFocalLength.Value;
        }

        private void AnglePerSecondUpDown_ValueChanged(object sender, EventArgs e)
        {
            angleDelta = (double)this.AnglePerSecondUpDown.Value / 1000 / fps;
        }

        private void button1_Click(object sender, EventArgs e)
        {
            this.NumericUpDownX.Value = 0;
            this.NumericUpDownY.Value = 0;
            this.NumericUpDownZ.Value = 0;
        }

        private void TrackBarRotateModel_Scroll(object sender, EventArgs e)
        {
            this.autoRotate.Checked = false;
            angle = (double)this.TrackBarRotateModel.Value / 20000D;
        }


        private double[] Rotate(double[] vertex, double degrees)
        {
            double radians = degrees * 180 / Math.PI;

            Matrix vector = new Matrix(
                (float)vertex[0], 0,
                (float)vertex[2], 0,
                0, 0
                );

            Matrix transMatrix = new Matrix(
                (float)Math.Cos(radians), (float)-Math.Sin(radians),
                (float)Math.Sin(radians), (float)Math.Cos(radians),
                0, 0
                );

            vector.Multiply(transMatrix);

            return new double[]
            {
                vector.Elements[0] - xOffset,
                vertex[1] - yOffset,
                vector.Elements[2] - zOffset - 5,
            };
        }

        private double[] Scale(double[] point)
        {
            return new double[2]
            {
                point[0] * canvas.Width + canvas.Width/2,
                point[1] * canvas.Height + canvas.Height/2
            };
        }
        private double[] Project(double[] vertex)
        {
            return new double[2] {
                (focalLength * vertex[0] / vertex[2]),
                (focalLength * vertex[1] / vertex[2])
            };
        }

        private void Draw(double[,] mesh, int[,] edges)
        {
            render = new float[mesh.Length / 3, 2];
            canvas = new Bitmap(600, 600);
            Graphics g = Graphics.FromImage(canvas);

            //vv Code that draws goes here vv

            for (int index = 0; index < mesh.Length / 3; index++)
            {
                double[] vertex = new double[3] { mesh[index, 0], mesh[index, 1], mesh[index, 2] };

                double[] point = Scale(Project(Rotate(vertex, angle)));
                render[index, 0] = (float)point[0];
                render[index, 1] = (float)point[1];

                double x = point[0];
                double y = point[1];

                if (showCircles)
                {
                    g.DrawEllipse(blackPen, new Rectangle((int)x - 10, (int)y - 10, 20, 20));
                }
            }


            // draws edges
            for (int i = 0; i < edges.Length / 3; i++)
            {
                Pen pen = pens[(int)edges[i, 2]];

                float x1 = render[edges[i, 0], 0];
                float y1 = render[edges[i, 0], 1];

                float x2 = render[edges[i, 1], 0];
                float y2 = render[edges[i, 1], 1];

                g.DrawLine(pen, x1, y1, x2, y2);
            }


            g.Flush();
            MeshRenderWindow.Image = canvas;
        }

        private void Frame(object sender, EventArgs e)  //run this logic each timer tick
        {
            if (this.DropdownMesh.Text == "Sphere")
            {
                //this.checkBoxShowCorners.Checked = true;
                Draw(sphere, sphereEdges);
            }
            else if (this.DropdownMesh.Text == "Pyramid")
            {
                Draw(pyramid, pyramidEdges);
            }
            else
            {
                Draw(cube, cubeEdges);
            }


            if (!doAutoRotate)
            {
                angle += angleDelta;
                if (angle >= 720 || angle <= -720)
                {
                    angle = -angle;
                }
            }
        }

    }
}
